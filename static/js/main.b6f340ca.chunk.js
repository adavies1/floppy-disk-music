(this["webpackJsonpfloppy-disk-music"]=this["webpackJsonpfloppy-disk-music"]||[]).push([[0],{10:function(e,t,n){e.exports={navList:"Header_navList__2sir2",navLink:"Header_navLink__3Cvbd",active:"Header_active__3GX0s"}},11:function(e,t,n){e.exports={songTable:"SongList_songTable__3iwG3",noWrap:"SongList_noWrap__dxJ0t",mobileSongTable:"SongList_mobileSongTable__2lNnP",mobileSong:"SongList_mobileSong__LpCCG",mobileSongControls:"SongList_mobileSongControls__1ZCC3"}},15:function(e,t,n){e.exports={buttons:"PlayerControls_buttons__2Q_jW",imageContainer:"PlayerControls_imageContainer__1cIVJ",boxImage:"PlayerControls_boxImage__VEoIC",songName:"PlayerControls_songName__1eDfD"}},20:function(e,t,n){e.exports={Box:"Box_Box__1zQUc",orange:"Box_orange__OLv20",stickToTop:"Box_stickToTop__2yK_e"}},24:function(e,t,n){e.exports={IconButton:"IconButton_IconButton__ovxH-",icon:"IconButton_icon__3_7uf"}},26:function(e,t,n){e.exports={IconLink:"IconLink_IconLink__3PrTB",icon:"IconLink_icon__3kPXE"}},33:function(e,t,n){e.exports={table:"Table_table__3A0m9"}},34:function(e,t,n){e.exports={Grid:"Grid_Grid__1He54"}},35:function(e,t,n){e.exports=n(50)},40:function(e,t,n){},41:function(e,t,n){},50:function(e,t,n){"use strict";n.r(t);var a,r=n(0),o=n.n(r),s=n(29),c=n.n(s),l=(n(40),n(16)),i=(n(41),n(14)),u=n(9),m=n.n(u),p=n(30),d=n(31);!function(e){e[e.NTSC=7159090.5]="NTSC",e[e.PAL=7093789.2]="PAL"}(a||(a={}));var f=function(e,t,n,a){return new(n||(n=Promise))((function(r,o){function s(e){try{l(a.next(e))}catch(t){o(t)}}function c(e){try{l(a.throw(e))}catch(t){o(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}l((a=a.apply(e,t||[])).next())}))};function h(e){return f(this,void 0,void 0,m.a.mark((function t(){return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return","string"===typeof e?k(e):g(e));case 1:case"end":return t.stop()}}),t)})))}function g(e){return new Promise((function(t,n){var a=new FileReader;a.onload=function(){t(a.result)},a.onerror=function(){n("TIMEOUT")},a.onabort=function(){n("ABORT")},console.log("[INFO] Attempting to read file:",e),a.readAsArrayBuffer(e)}))}function k(e){return new Promise((function(t,n){var a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="arraybuffer",a.onload=function(){a.response?t(a.response):n("EMPTY")},a.onerror=function(){n("ERROR")},a.ontimeout=function(){n("TIMEOUT")},a.onabort=function(){n("ABORT")},console.log("[INFO] Attempting to read file from URL: '".concat(e,"'")),a.send()}))}function E(e,t,n){return String.fromCharCode.apply(null,Array.from(new Uint8Array(e.slice(t,n))))}function y(e){var t=b(e),n=4;switch(t){case"8CHN":case"FLT8":case"CD81":case"OKTA":case"OCTA":n=8;break;case"6CHN":n=6;break;case"2CHN":n=2;break;default:/^[0-9][0-9]C[H,N]$/.test(t)?n=parseInt(t.substr(0,2)):/^TDZ[0-9]$/.test(t)?n=parseInt(t.substr(3)):/^[579]CHN$/.test(t)&&(n=parseInt(t.substr(0,1)))}return n}function b(e){return E(e,1080,1084)}var v=[{name:"protracker",getInitOptions:function(e){if(!function(e){return"Unknown format"!==function(e){var t=b(e),n="Unknown format";switch(t){case"M.K.":n="ProTracker";break;case"M!K!":case"M&K!":n="ProTracker (extended patterns)";break;case"6CHN":n="ProTracker (6 channels)";break;case"8CHN":n="ProTracker (8 channels)";break;case"2CHN":n="FastTracker (2 channels)";break;case"CD81":case"OKTA":n="Oktalyzer";break;case"OCTA":n="Octamed";break;case"FLT4":n="StarTrekker";break;case"FLT8":n="StarTrekker (8 channels)";break;default:/^[0-9][0-9]CH$/.test(t)&&(n="FastTracker (".concat(parseInt(t.substr(0,2))," channels)")),/^[0-9][0-9]CN$/.test(t)?n="TakeTracker (".concat(parseInt(t.substr(0,2))," channels)"):/^TDZ[0-9]$/.test(t)?n="TakeTracker (".concat(parseInt(t.substr(3))," channels)"):/^[579]CHN$/.test(t)&&(n="TakeTracker (".concat(parseInt(t.substr(0,1))," channels)"))}return n}(e)}(e))throw new Error;var t=y(e);return{numberOfOutputs:t,outputChannelCount:Object(i.a)(new Array(t)).map((function(e){return 1})),processorOptions:{fileData:e}}},options:{},path:"/floppy-disk-music/players/protracker.js"}],_=function(e,t,n,a){return new(n||(n=Promise))((function(r,o){function s(e){try{l(a.next(e))}catch(t){o(t)}}function c(e){try{l(a.throw(e))}catch(t){o(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}l((a=a.apply(e,t||[])).next())}))},w=function(){function e(t,n){var a=this;Object(p.a)(this,e),this.connected=!1,this.status="not-ready",this.getInfo=function(){a.player&&a.player.port.postMessage({cmd:"getInfo"})},this.onMessage=function(e){"ended"===e.data.message&&(console.info("[Wurlitzer] - Song has ended"),a.stop()),a.extraMessageHandler(e)},this.audioContext=t||("undefined"!==typeof window?new(window.AudioContext||window.webkitAudioContext):globalThis),this.extraMessageHandler=n||function(e){}}return Object(d.a)(e,[{key:"load",value:function(e){return _(this,void 0,void 0,m.a.mark((function t(){var n,a;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h(e);case 2:return n=t.sent,t.next=5,C(n,this.audioContext);case 5:a=t.sent,this.stop(),this.fileData=n,this.player=a,this.player.port.onmessage=this.onMessage,this.mixer=T(this.audioContext,this.player),this.status="ready";case 12:case"end":return t.stop()}}),t,this)})))}},{key:"pause",value:function(){this.player&&"ready"===this.status&&(this._disconnect(),this.player.port.postMessage({cmd:"pause"}))}},{key:"play",value:function(){return _(this,void 0,void 0,m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.fileData||"stopped"!==this.status){e.next=7;break}return e.next=3,C(this.fileData,this.audioContext);case 3:this.player=e.sent,this.player.port.onmessage=this.onMessage,this.mixer=T(this.audioContext,this.player),this.status="ready";case 7:this.player&&"ready"===this.status&&(this._connect(),this.player.port.postMessage({cmd:"play"}));case 8:case"end":return e.stop()}}),e,this)})))}},{key:"previousSubtrack",value:function(){this.player&&this.player.port.postMessage({cmd:"previousSubtrack"})}},{key:"nextSubtrack",value:function(){this.player&&this.player.port.postMessage({cmd:"nextSubtrack"})}},{key:"reset",value:function(){this.player&&this.player.port.postMessage({cmd:"reset"})}},{key:"setSubtrack",value:function(e){this.player&&this.player.port.postMessage({cmd:"setSubtrack",data:e})}},{key:"skipToPosition",value:function(e){this.player&&this.player.port.postMessage({cmd:"skipToPosition",data:e})}},{key:"stop",value:function(){this.player&&"ready"===this.status&&(this._disconnect(),this.player.port.postMessage({cmd:"stop"}),this.status="stopped")}},{key:"_connect",value:function(){this.mixer&&!this.connected&&(this.mixer.connect(this.audioContext.destination),this.connected=!0)}},{key:"_disconnect",value:function(){this.mixer&&this.connected&&(this.mixer.disconnect(),this.connected=!1)}}]),e}();function T(e,t){var n=new ChannelMergerNode(e,{numberOfInputs:2});return 4===t.numberOfOutputs?([0,3].forEach((function(e){return t.connect(n,e,0)})),[1,2].forEach((function(e){return t.connect(n,e,1)}))):(Object(i.a)(new Array(t.numberOfOutputs)).map((function(e,t){return t})).filter((function(e){return e%2===0})).forEach((function(e){return t.connect(n,e,0)})),Object(i.a)(new Array(t.numberOfOutputs)).map((function(e,t){return t})).filter((function(e){return e%2!==0})).forEach((function(e){return t.connect(n,e,1)}))),n}function C(e,t){return _(this,void 0,void 0,m.a.mark((function n(){var a;return m.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(v.forEach((function(t){try{a=Object.assign(Object.assign({},t),{options:t.getInitOptions(e)})}catch(n){}})),a){n.next=3;break}throw new Error("This file is not supported");case 3:return n.prev=3,n.abrupt("return",new AudioWorkletNode(t,a.name,a.options));case 7:return n.prev=7,n.t0=n.catch(3),n.next=11,t.audioWorklet.addModule(a.path);case 11:return n.abrupt("return",new AudioWorkletNode(t,a.name,a.options));case 12:case"end":return n.stop()}}),n,null,[[3,7]])})))}var S=n(8),x=n(2),N=function(e){return o.a.createElement(o.a.Fragment,null,o.a.createElement("p",null,"Welcome! To begin, please go to the ",o.a.createElement(S.b,{to:"/songs"},"song list"),", and then press the play button next to a track. Currently, only Chrome and Firefox are supported. ",o.a.createElement("b",null,"The songs that play will be loud!")),o.a.createElement("h3",null,"What is this website?"),o.a.createElement("p",null,"This is a live demo of 'Floppy Disk Music', a website that aims to provide playback support for many older music formats found on computers from the 80s/90s, which tended to use floppy disks. It only currently supports 1 format, but the software has a modular design, ready for more players to be added in the future."),o.a.createElement("h3",null,"What's special about this website / project?"),o.a.createElement("p",null,"All processing is done in the browser. That means the original file (the same file found on the floppy disk) is decoded, checked for compatibility, and then played back, all using javascript. There is no backend processing of any kind, only the serving of files."),o.a.createElement("p",null,"The frontend is using both React and the ",o.a.createElement("a",{href:"https://github.com/adavies1/wurlitzer"},"Wurlizter")," audio playback engine (also written by me)."))},O=function(e){return o.a.createElement("ul",null,o.a.createElement("li",null,o.a.createElement("strong",null,"Title: ")," ",e.songListing.name),o.a.createElement("li",null,o.a.createElement("strong",null,"Title (from file): ")," ",e.song.title),o.a.createElement("li",null,o.a.createElement("strong",null,"Format: ")," ",e.songListing.format),o.a.createElement("li",null,o.a.createElement("strong",null,"Channels: ")," ",e.song.channelCount),o.a.createElement("li",null,o.a.createElement("strong",null,"Size: ")," ",e.songListing.size),o.a.createElement("li",null,o.a.createElement("strong",null,"Signature: ")," ",e.song.signature),o.a.createElement("li",null,o.a.createElement("strong",null,"Pattern count: ")," ",e.song.patternCount),o.a.createElement("li",null,o.a.createElement("strong",null,"Pattern sequence length: ")," ",e.song.songLength))},I=n(33),L=n.n(I),P=function(e){return o.a.createElement("table",{className:"".concat(L.a.table," ").concat(e.className||"")},e.children)},B=function(e){return o.a.createElement(P,null,o.a.createElement("tbody",null,o.a.createElement("tr",null,o.a.createElement("th",null,"Name"),o.a.createElement("th",null,"Sample length (bytes)")),e.song.samples.map((function(e,t){return o.a.createElement("tr",{key:t},o.a.createElement("td",null,e.name),o.a.createElement("td",null,e.length))}))))},z=function(e){return o.a.createElement(o.a.Fragment,null,e.currentSong&&e.currentSongListing&&e.player?o.a.createElement(o.a.Fragment,null,o.a.createElement("h3",null,"Song info"),o.a.createElement(O,{song:e.currentSong,songListing:e.currentSongListing}),o.a.createElement("h3",null,"Samples"),o.a.createElement(B,{song:e.currentSong})):o.a.createElement("p",null,"There is no song loaded. Please load a song from the ",o.a.createElement(S.b,{to:"/songs"},"songs list")," and then come back."))},M=n(11),A=n.n(M),j=n(24),F=n.n(j),H=n(19),D=function(e){return o.a.createElement("button",{type:"button",className:F.a.IconButton,onClick:e.onClick,title:e.title},o.a.createElement(H.a,{icon:e.icon,className:F.a.icon}))},K=n(26),W=n.n(K),R=function(e){return o.a.createElement("a",{href:e.href,className:W.a.IconLink,title:e.title},o.a.createElement(H.a,{icon:e.icon,className:W.a.icon}))},G=n(6),$=function(e){return o.a.createElement(o.a.Fragment,null,o.a.createElement(P,{className:A.a.songTable},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",null,"Title"),o.a.createElement("th",null,"Format"),o.a.createElement("th",null,"Channels"),o.a.createElement("th",null,"Size"),o.a.createElement("th",null,"\xa0"))),o.a.createElement("tbody",null,e.list.map((function(t){return o.a.createElement("tr",{key:t.name},o.a.createElement("td",null,t.name),o.a.createElement("td",null,t.format),o.a.createElement("td",null,t.channels),o.a.createElement("td",null,t.size),o.a.createElement("td",{className:A.a.noWrap},o.a.createElement(D,{icon:G.c,onClick:function(){return e.load(t)},title:"Load and play"}),o.a.createElement(R,{icon:G.a,href:t.src,title:"Download"})))})))),o.a.createElement("ul",{className:A.a.mobileSongTable},e.list.map((function(t){return o.a.createElement("li",{className:A.a.mobileSong,key:t.name},o.a.createElement("div",null,o.a.createElement("strong",{className:A.a.mobileSongTitle},t.name),o.a.createElement("div",{className:A.a.mobileSongInfo},"".concat(t.format,", ").concat(t.channels," channels, ").concat(t.size))),o.a.createElement("div",{className:A.a.mobileSongControls},o.a.createElement(D,{icon:G.c,onClick:function(){return e.load(t)},title:"Load and play"}),o.a.createElement(R,{icon:G.a,href:t.src,title:"Download"})))}))))},U=function(e){return o.a.createElement($,{list:e.songs,load:e.load})},J=n(20),X=n.n(J),Z=function(e){return o.a.createElement("div",Object.assign({className:"".concat(X.a.Box," ").concat(e.orange?X.a.orange:""," ").concat(e.stickToTop?X.a.stickToTop:""," ")},e),e.children)},q=n(34),Q=n.n(q),V=function(e){return o.a.createElement("div",{className:Q.a.Grid},e.children)},Y=n(10),ee=n.n(Y),te=function(e){return o.a.createElement("header",{className:ee.a.header},o.a.createElement("h1",null,"Floppy Disk Music"),o.a.createElement("h2",null,"Javascript retro music player"),o.a.createElement(Z,null,o.a.createElement("nav",null,o.a.createElement("ul",{className:ee.a.navList},o.a.createElement("li",null,o.a.createElement(S.c,{className:ee.a.navLink,activeClassName:ee.a.active,to:"/",exact:!0},"Home")),o.a.createElement("li",null,o.a.createElement(S.c,{className:ee.a.navLink,activeClassName:ee.a.active,to:"/songs",exact:!0},"Songs")),o.a.createElement("li",null,o.a.createElement(S.c,{className:ee.a.navLink,activeClassName:ee.a.active,to:"/current-song",exact:!0},"Current Song"))))))},ne=n(15),ae=n.n(ne),re=function(e){return o.a.createElement("img",{className:ae.a.boxImage,src:"".concat("/floppy-disk-music","/img/boxes/").concat(e.image||"unknown.jpg"),alt:e.name})},oe=function(e){return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:ae.a.imageContainer},re(e.currentSong)),o.a.createElement("p",null,o.a.createElement("strong",{className:ae.a.songName},e.currentSong.name),o.a.createElement("br",null),"".concat(e.currentSong.format,", ").concat(e.currentSong.channels," channels, ").concat(e.currentSong.size)),o.a.createElement("div",{className:ae.a.buttons},o.a.createElement(D,{icon:G.c,onClick:e.play,title:"Play"}),o.a.createElement(D,{icon:G.b,onClick:e.pause,title:"Pause"}),o.a.createElement(D,{icon:G.d,onClick:e.stop,title:"Stop"})))},se=[{src:"".concat("/floppy-disk-music","/songs/dragonsfunk.mod"),name:"Dragons Funk",format:"Protracker",channels:4,size:"193KB"},{src:"".concat("/floppy-disk-music","/songs/Skid_Row2.mod"),name:"Skid Row 2",format:"Protracker",channels:4,size:"47KB"},{src:"".concat("/floppy-disk-music","/songs/SuperFrogTitle.mod"),name:"Super Frog",format:"Protracker",channels:4,image:"superfrog.jpg",size:"74KB"},{src:"".concat("/floppy-disk-music","/songs/too-speedy.mod"),name:"Too Speedy",format:"Protracker",channels:4,size:"37KB"},{src:"".concat("/floppy-disk-music","/songs/wizkid_1.mod"),name:"Wizkid round 1/8",format:"Protracker",channels:4,image:"wizkid.jpg",size:"38KB"},{src:"".concat("/floppy-disk-music","/songs/bedroomd.mod"),name:"Bedroom Door",format:"Protracker",channels:4,size:"85KB"},{src:"".concat("/floppy-disk-music","/songs/dsots-intro.mod"),name:"The Dark Side of the Spoon Intro",format:"Protracker",channels:4,size:"179KB"},{src:"".concat("/floppy-disk-music","/songs/moonclow.mod"),name:"A Clown in the Moon",format:"Protracker",channels:8,size:"211KB"},{src:"".concat("/floppy-disk-music","/songs/ecodreams.mod"),name:"Ecodreams",format:"Protracker",channels:4,size:"29KB"},{src:"".concat("/floppy-disk-music","/songs/wizard-2.mod"),name:"Wizard2",format:"Protracker",channels:4,size:"22KB"},{src:"".concat("/floppy-disk-music","/songs/bitner.mod"),name:"Bitner",format:"Protracker",channels:4,size:"130KB"}];var ce=function(){var e=Object(r.useState)(void 0),t=Object(l.a)(e,2),n=t[0],a=t[1],s=Object(r.useState)(void 0),c=Object(l.a)(s,2),i=c[0],u=c[1],m=Object(r.useState)(!1),p=Object(l.a)(m,2),d=p[0],f=p[1],h=Object(r.useState)(void 0),g=Object(l.a)(h,2),k=g[0],E=g[1],y=function(e){var t=k||new w(void 0,b);k||E(t),t.load(e.src).then((function(){a(e),f(!0),t.play(),t.getInfo()}))},b=function(e){if(e.data.message)switch(e.data.message){case"songInfo":u(e.data.value),console.log(e.data.value)}};return o.a.createElement(S.a,{basename:"floppy-disk-music"},o.a.createElement("div",{className:"App"},o.a.createElement(te,null),o.a.createElement(V,null,o.a.createElement(Z,null,o.a.createElement(x.c,null,o.a.createElement(x.a,{path:"/songs",render:function(e){return o.a.createElement(U,Object.assign({},e,{songs:se,load:y}))}}),o.a.createElement(x.a,{path:"/current-song",render:function(e){return o.a.createElement(z,Object.assign({},e,{currentSong:i,currentSongListing:n,player:k}))}}),o.a.createElement(x.a,{component:N}))),o.a.createElement("div",null,o.a.createElement(Z,{stickToTop:!0},n?o.a.createElement(oe,{ready:d,play:function(){k&&k.play()},pause:function(){k&&k.pause()},stop:function(){k&&k.stop()},currentSong:n}):o.a.createElement("p",{style:{textAlign:"center"}},"No song loaded"))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(ce,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[35,1,2]]]);
//# sourceMappingURL=main.b6f340ca.chunk.js.map