(this["webpackJsonpchiptune-player-frontend"]=this["webpackJsonpchiptune-player-frontend"]||[]).push([[0],[,,,,,,function(e,t,n){e.exports={buttons:"PlayerControls_buttons__2Q_jW",imageContainer:"PlayerControls_imageContainer__1cIVJ",boxImage:"PlayerControls_boxImage__VEoIC",songName:"PlayerControls_songName__1eDfD"}},,,,,function(e,t,n){e.exports={Box:"Box_Box__1zQUc",orange:"Box_orange__OLv20"}},function(e,t,n){e.exports={IconButton:"IconButton_IconButton__ovxH-",icon:"IconButton_icon__3_7uf"}},,function(e,t,n){e.exports={IconLink:"IconLink_IconLink__3PrTB",icon:"IconLink_icon__3kPXE"}},,,,,function(e,t,n){e.exports={Grid:"Grid_Grid__1He54"}},function(e,t,n){},function(e,t,n){e.exports={songTable:"SongList_songTable__3iwG3"}},function(e,t,n){e.exports=n(35)},,,,,function(e,t,n){},function(e,t,n){},,,,,,,function(e,t,n){"use strict";n.r(t);var a,r=n(0),o=n.n(r),c=n(16),s=n.n(c),i=(n(27),n(9)),u=(n(28),n(5)),l=n(3),p=n.n(l),m=n(17),f=n(18);!function(e){e[e.NTSC=7159090.5]="NTSC",e[e.PAL=7093789.2]="PAL"}(a||(a={}));var d=function(e,t,n,a){return new(n||(n=Promise))((function(r,o){function c(e){try{i(a.next(e))}catch(t){o(t)}}function s(e){try{i(a.throw(e))}catch(t){o(t)}}function i(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}i((a=a.apply(e,t||[])).next())}))};function h(e){return d(this,void 0,void 0,p.a.mark((function t(){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return","string"===typeof e?y(e):k(e));case 1:case"end":return t.stop()}}),t)})))}function k(e){return new Promise((function(t,n){var a=new FileReader;a.onload=function(){t(a.result)},a.onerror=function(){n("TIMEOUT")},a.onabort=function(){n("ABORT")},console.log("[INFO] Attempting to read file:",e),a.readAsArrayBuffer(e)}))}function y(e){return new Promise((function(t,n){var a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="arraybuffer",a.onload=function(){a.response?t(a.response):n("EMPTY")},a.onerror=function(){n("ERROR")},a.ontimeout=function(){n("TIMEOUT")},a.onabort=function(){n("ABORT")},console.log("[INFO] Attempting to read file from URL: '".concat(e,"'")),a.send()}))}function g(e,t,n){return String.fromCharCode.apply(null,Array.from(new Uint8Array(e.slice(t,n))))}function b(e){var t=v(e),n=4;switch(t){case"8CHN":case"FLT8":case"CD81":case"OKTA":case"OCTA":n=8;break;case"6CHN":n=6;break;case"2CHN":n=2;break;default:/^[0-9][0-9]C[H,N]$/.test(t)?n=parseInt(t.substr(0,2)):/^TDZ[0-9]$/.test(t)?n=parseInt(t.substr(3)):/^[579]CHN$/.test(t)&&(n=parseInt(t.substr(0,1)))}return n}function v(e){return g(e,1080,1084)}var w=[{name:"protracker",getInitOptions:function(e){if(!function(e){return"Unknown format"!==function(e){var t=v(e),n="Unknown format";switch(t){case"M.K.":n="ProTracker";break;case"M!K!":case"M&K!":n="ProTracker (extended patterns)";break;case"6CHN":n="ProTracker (6 channels)";break;case"8CHN":n="ProTracker (8 channels)";break;case"2CHN":n="FastTracker (2 channels)";break;case"CD81":case"OKTA":n="Oktalyzer";break;case"OCTA":n="Octamed";break;case"FLT4":n="StarTrekker";break;case"FLT8":n="StarTrekker (8 channels)";break;default:/^[0-9][0-9]CH$/.test(t)&&(n="FastTracker (".concat(parseInt(t.substr(0,2))," channels)")),/^[0-9][0-9]CN$/.test(t)?n="TakeTracker (".concat(parseInt(t.substr(0,2))," channels)"):/^TDZ[0-9]$/.test(t)?n="TakeTracker (".concat(parseInt(t.substr(3))," channels)"):/^[579]CHN$/.test(t)&&(n="TakeTracker (".concat(parseInt(t.substr(0,1))," channels)"))}return n}(e)}(e))throw new Error;var t=b(e);return{numberOfOutputs:t,outputChannelCount:Object(u.a)(new Array(t)).map((function(e){return 1})),processorOptions:{fileData:e}}},options:{},path:"/floppy-disk-music/players/protracker.js"}],E=function(e,t,n,a){return new(n||(n=Promise))((function(r,o){function c(e){try{i(a.next(e))}catch(t){o(t)}}function s(e){try{i(a.throw(e))}catch(t){o(t)}}function i(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}i((a=a.apply(e,t||[])).next())}))},x=function(){function e(t){var n=this;Object(m.a)(this,e),this.connected=!1,this.status="not-ready",this.onMessage=function(e){"ended"===e.data&&(console.info("[Wurlitzer] - Song has ended"),n.stop())},this.audioContext=t||("undefined"!==typeof window?new(window.AudioContext||window.webkitAudioContext):globalThis)}return Object(f.a)(e,[{key:"load",value:function(e){return E(this,void 0,void 0,p.a.mark((function t(){var n,a;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h(e);case 2:return n=t.sent,t.next=5,T(n,this.audioContext);case 5:a=t.sent,this.stop(),this.fileData=n,this.player=a,this.player.port.onmessage=this.onMessage,this.mixer=C(this.audioContext,this.player),this.status="ready";case 12:case"end":return t.stop()}}),t,this)})))}},{key:"pause",value:function(){this.player&&"ready"===this.status&&(this._disconnect(),this.player.port.postMessage({cmd:"pause"}))}},{key:"play",value:function(){return E(this,void 0,void 0,p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.fileData||"stopped"!==this.status){e.next=7;break}return e.next=3,T(this.fileData,this.audioContext);case 3:this.player=e.sent,this.player.port.onmessage=this.onMessage,this.mixer=C(this.audioContext,this.player),this.status="ready";case 7:this.player&&"ready"===this.status&&(this._connect(),this.player.port.postMessage({cmd:"play"}));case 8:case"end":return e.stop()}}),e,this)})))}},{key:"previousSubtrack",value:function(){this.player&&this.player.port.postMessage({cmd:"previousSubtrack"})}},{key:"nextSubtrack",value:function(){this.player&&this.player.port.postMessage({cmd:"nextSubtrack"})}},{key:"reset",value:function(){this.player&&this.player.port.postMessage({cmd:"reset"})}},{key:"setSubtrack",value:function(e){this.player&&this.player.port.postMessage({cmd:"setSubtrack",data:e})}},{key:"skipToPosition",value:function(e){this.player&&this.player.port.postMessage({cmd:"skipToPosition",data:e})}},{key:"stop",value:function(){this.player&&"ready"===this.status&&(this._disconnect(),this.player.port.postMessage({cmd:"stop"}),this.status="stopped")}},{key:"_connect",value:function(){this.mixer&&!this.connected&&(this.mixer.connect(this.audioContext.destination),this.connected=!0)}},{key:"_disconnect",value:function(){this.mixer&&this.connected&&(this.mixer.disconnect(),this.connected=!1)}}]),e}();function C(e,t){var n=new ChannelMergerNode(e,{numberOfInputs:2});return 4===t.numberOfOutputs?([0,3].forEach((function(e){return t.connect(n,e,0)})),[1,2].forEach((function(e){return t.connect(n,e,1)}))):(Object(u.a)(new Array(t.numberOfOutputs)).map((function(e,t){return t})).filter((function(e){return e%2===0})).forEach((function(e){return t.connect(n,e,0)})),Object(u.a)(new Array(t.numberOfOutputs)).map((function(e,t){return t})).filter((function(e){return e%2!==0})).forEach((function(e){return t.connect(n,e,1)}))),n}function T(e,t){return E(this,void 0,void 0,p.a.mark((function n(){var a;return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(w.forEach((function(t){try{a=Object.assign(Object.assign({},t),{options:t.getInitOptions(e)})}catch(n){}})),a){n.next=3;break}throw new Error("This file is not supported");case 3:return n.prev=3,n.abrupt("return",new AudioWorkletNode(t,a.name,a.options));case 7:return n.prev=7,n.t0=n.catch(3),n.next=11,t.audioWorklet.addModule(a.path);case 11:return n.abrupt("return",new AudioWorkletNode(t,a.name,a.options));case 12:case"end":return n.stop()}}),n,null,[[3,7]])})))}var _=n(11),O=n.n(_),N=function(e){return o.a.createElement("div",Object.assign({className:"".concat(O.a.Box," ").concat(e.orange?O.a.orange:"")},e),e.children)},I=n(19),P=n.n(I),S=function(e){return o.a.createElement("div",{className:P.a.Grid},e.children)},A=n(20),M=n.n(A),j=function(e){return o.a.createElement("header",{className:M.a.header},o.a.createElement("h1",null,"Floppy Disk Music"),o.a.createElement("h2",null,"Javascript retro music player"))},B=n(6),D=n.n(B),F=n(12),L=n.n(F),H=n(8),R=function(e){return o.a.createElement("button",{type:"button",className:L.a.IconButton,onClick:e.onClick,title:e.title},o.a.createElement(H.a,{icon:e.icon,className:L.a.icon}))},W=n(2),$=function(e){return o.a.createElement("img",{className:D.a.boxImage,src:"/img/boxes/".concat(e.image||"unknown.jpg"),alt:e.name})},U=function(e){return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:D.a.imageContainer},$(e.currentSong)),o.a.createElement("p",{className:D.a.songName},e.currentSong.name),o.a.createElement("div",{className:D.a.buttons},o.a.createElement(R,{icon:W.c,onClick:e.play,title:"Play"}),o.a.createElement(R,{icon:W.b,onClick:e.pause,title:"Pause"}),o.a.createElement(R,{icon:W.d,onClick:e.stop,title:"Stop"})))},z=n(21),G=n.n(z),K=n(14),J=n.n(K),Q=function(e){return o.a.createElement("a",{href:e.href,className:J.a.IconLink,title:e.title},o.a.createElement(H.a,{icon:e.icon,className:J.a.icon}))},V=function(e){return o.a.createElement(o.a.Fragment,null,o.a.createElement("table",{className:G.a.songTable},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",null,"Title"),o.a.createElement("th",null,"Format"),o.a.createElement("th",null,"Channels"),o.a.createElement("th",null,"\xa0"))),o.a.createElement("tbody",null,e.list.map((function(t){return o.a.createElement("tr",{key:t.name},o.a.createElement("td",null,t.name),o.a.createElement("td",null,t.format),o.a.createElement("td",null,t.channels),o.a.createElement("td",null,o.a.createElement(R,{icon:W.c,onClick:function(){return e.load(t)},title:"Load and play"}),o.a.createElement(Q,{icon:W.a,href:t.src,title:"Download"})))})))))},X=[{src:"songs/dragonsfunk.mod",name:"Dragons Funk",format:"Protracker",channels:4},{src:"songs/Skid_Row2.mod",name:"Skid Row 2",format:"Protracker",channels:4},{src:"songs/SuperFrog.mod",name:"Super Frog",format:"Protracker",channels:4,image:"superfrog.jpg"},{src:"songs/too-speedy.mod",name:"Too Speedy",format:"Protracker",channels:4},{src:"songs/wizkid_1.mod",name:"Wizkid round 1/8",format:"Protracker",channels:4,image:"wizkid.jpg"},{src:"songs/bedroomd.mod",name:"Bedroom Door",format:"Protracker",channels:4},{src:"songs/dsots-intro.mod",name:"The Dark Side of the Spoon Intro",format:"Protracker",channels:4},{src:"songs/moonclow.mod",name:"A Clown in the Moon",format:"Protracker",channels:8}];var Z=function(){var e=Object(r.useState)(void 0),t=Object(i.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(!1),s=Object(i.a)(c,2),u=s[0],l=s[1],p=Object(r.useState)(void 0),m=Object(i.a)(p,2),f=m[0],d=m[1];return o.a.createElement("div",{className:"App"},o.a.createElement(j,null),o.a.createElement(S,null,o.a.createElement(N,null,o.a.createElement(V,{list:X,load:function(e){var t=f||new x;f||d(t),t.load(e.src).then((function(){a(e),l(!0),t.play()}))}})),o.a.createElement(N,null,n?o.a.createElement(U,{ready:u,play:function(){f&&f.play()},pause:function(){f&&f.pause()},stop:function(){f&&f.stop()},currentSong:n}):o.a.createElement("p",null,"No song loaded"))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(Z,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[22,1,2]]]);
//# sourceMappingURL=main.0dd64a6a.chunk.js.map